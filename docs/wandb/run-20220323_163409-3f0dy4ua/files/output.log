[33m[W 2022-03-23 16:34:28,571][39m Trial 0 failed because of the following error: RuntimeError("Can't call numpy() on Tensor that requires grad. Use tensor.detach().numpy() instead.")
Traceback (most recent call last):
  File "/Users/AFischer/opt/anaconda3/envs/ai_medicine/lib/python3.8/site-packages/optuna/study/_optimize.py", line 213, in _run_trial
    value_or_values = func(trial)
  File "/var/folders/16/mg5_s98x3yd90kq7mmfmk3pr0000gn/T/ipykernel_597/748172136.py", line 76, in objective_tcn_model_samp_en
    loss = opt_tcn.train(trial, custom_train_loader_samp_en, custom_val_loader_samp_en, config,
  File "/var/folders/16/mg5_s98x3yd90kq7mmfmk3pr0000gn/T/ipykernel_597/282382737.py", line 139, in train
    wandb.log({"epoch": epoch, "train_logits": wandb.Histogram(flattened_train_logits.to("cpu")), "val_logits": wandb.Histogram(flattened_val_logits.to("cpu")), "train_loss": avg_sample_train_loss_epoch, "val_loss": avg_sample_val_loss_epoch}, step=log_step)
  File "/Users/AFischer/opt/anaconda3/envs/ai_medicine/lib/python3.8/site-packages/wandb/sdk/data_types.py", line 411, in __init__
    self.histogram, self.bins = np.histogram(sequence, bins=num_bins)
  File "<__array_function__ internals>", line 5, in histogram
  File "/Users/AFischer/opt/anaconda3/envs/ai_medicine/lib/python3.8/site-packages/numpy/lib/histograms.py", line 790, in histogram
    a, weights = _ravel_and_check_weights(a, weights)
  File "/Users/AFischer/opt/anaconda3/envs/ai_medicine/lib/python3.8/site-packages/numpy/lib/histograms.py", line 285, in _ravel_and_check_weights
    a = np.asarray(a)
  File "/Users/AFischer/opt/anaconda3/envs/ai_medicine/lib/python3.8/site-packages/numpy/core/_asarray.py", line 102, in asarray
    return array(a, dtype, copy=False, order=order)
  File "/Users/AFischer/opt/anaconda3/envs/ai_medicine/lib/python3.8/site-packages/torch/_tensor.py", line 678, in __array__
    return self.numpy()
RuntimeError: Can't call numpy() on Tensor that requires grad. Use tensor.detach().numpy() instead.
Params: {'learning_rate': 0.005488262484885662, 'num_hidden_units_per_layer': 160, 'weight_decay': 4.264631251287246e-06, 'kernel_size': 5, 'num_epochs': 25, 'drop_out': 0.4533310482993088, 'batch_size': 60, 'reduced_seq_length': 70, 'num_levels': 4, 'stride': 1, 'pos_weight': tensor([6.8261])}
[32m[I 2022-03-23 16:36:45,225][39m A new study created in memory with name: no-name-523776e9-7526-460f-abb5-a0903384d064
The number of rows with infinite numbers that will be replaced with zero is: 0
The number of rows with NA numbers that will be replaced with zero is: 0
The number of rows with infinite numbers that will be replaced with zero is: 0
The number of rows with NA numbers that will be replaced with zero is: 0